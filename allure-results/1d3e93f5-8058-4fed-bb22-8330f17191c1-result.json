{"name": "test_change_pos[Espa\\xf1a-https://nuxqa4.avtest.ink/]", "status": "broken", "statusDetails": {"message": "Exception: No se pudo hacer clic en el botón Aplicar/Apply", "trace": "self = <test_case_5.TestCase5 object at 0x00000212F6F1F230>, browser = <selenium.webdriver.chrome.webdriver.WebDriver (session=\"4e5f0c2553fcdce23872a4e1f444f901\")>, base_url = 'https://nuxqa4.avtest.ink/'\npos_country = 'España'\n\n    @pytest.mark.parametrize(\"base_url\", [\n        \"https://nuxqa4.avtest.ink/\",\n        \"https://nuxqa5.avtest.ink/\"\n    ])\n    @pytest.mark.parametrize(\"pos_country\", [\n        \"Otros países\",\n        \"España\",\n        \"Chile\"\n    ])\n    def test_change_pos(self, browser, base_url, pos_country):\n        \"\"\"\n        Caso 5: Verificar cambio de POS (País)\n        - Seleccionar 3 POS: Otros países, España, Chile\n        - Verificar que cada cambio de POS se haga correctamente\n        \"\"\"\n        test_name = f\"test_change_pos_{pos_country.replace(' ', '_').lower()}\"\n        video_recorder = None\n        home_page = HomePage(browser)\n    \n        try:\n            # Configurar grabación de video\n            video_recorder = VideoRecorder(\n                test_name=test_name,\n                browser_name=browser.name\n            )\n            video_recorder.start_recording()\n    \n            with allure.step(f\"1. Navegar a la página principal: {base_url}\"):\n                home_page.navigate_to(base_url)\n                home_page.wait_for_page_load()\n                video_recorder.capture_frame(browser)\n                logger.info(f\"Navegado a: {base_url}\")\n    \n                # Tomar screenshot inicial\n                home_page.take_screenshot(f\"initial_{pos_country.replace(' ', '_')}.png\")\n    \n            with allure.step(f\"2. Cambiar POS a: {pos_country}\"):\n                home_page.select_pos(pos_country)\n                video_recorder.capture_frame(browser)\n                logger.info(f\"POS cambiado a: {pos_country}\")\n    \n                # Tomar screenshot después del cambio\n                home_page.take_screenshot(f\"after_pos_change_{pos_country.replace(' ', '_')}.png\")\n    \n            with allure.step(f\"3. Verificar que el POS {pos_country} se aplicó correctamente\"):\n                verification_result = home_page.verify_pos_changed(pos_country)\n                assert verification_result, f\"Falló la verificación del POS {pos_country}\"\n    \n                current_pos = home_page.get_current_pos()\n                logger.info(f\"POS actual detectado: {current_pos}\")\n    \n                video_recorder.capture_frame(browser)\n                logger.info(f\"POS {pos_country} verificado correctamente\")\n    \n            # Guardar resultado en base de datos - CORREGIDO: agregando parámetro 'language'\n            db = DatabaseManager()\n            db.save_test_result(\n                test_case_number=5,\n                test_case_name=f\"Change POS to {pos_country}\",\n                browser=browser.name,\n                language=\"español\",  # PARÁMETRO FALTANTE AGREGADO\n                status=\"PASS\",\n                url=base_url,\n                additional_info=f\"POS cambiado exitosamente a {pos_country}. Detectado: {current_pos}\"\n            )\n    \n            # Adjuntar evidencias a Allure\n            allure.attach(\n                browser.get_screenshot_as_png(),\n                name=f\"screenshot_pos_{pos_country.replace(' ', '_')}\",\n                attachment_type=allure.attachment_type.PNG\n            )\n    \n        except Exception as e:\n            # Capturar error y guardar en base de datos - CORREGIDO: agregando parámetro 'language'\n            error_msg = f\"Error en test_change_pos para {pos_country}: {str(e)}\"\n            logger.error(error_msg)\n    \n            if video_recorder:\n                video_recorder.capture_frame(browser)\n    \n            db = DatabaseManager()\n            db.save_test_result(\n                test_case_number=5,\n                test_case_name=f\"Change POS to {pos_country}\",\n                browser=browser.name,\n                language=\"español\",  # PARÁMETRO FALTANTE AGREGADO\n                status=\"FAIL\",\n                url=base_url,\n                additional_info=error_msg\n            )\n    \n            # Adjuntar screenshot de error\n            allure.attach(\n                browser.get_screenshot_as_png(),\n                name=f\"error_screenshot_pos_{pos_country.replace(' ', '_')}\",\n                attachment_type=allure.attachment_type.PNG\n            )\n    \n>           raise e\n\ntests\\test_case_5.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntests\\test_case_5.py:50: in test_change_pos\n    home_page.select_pos(pos_country)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <pages.home_page.HomePage object at 0x00000212F71565D0>, country_name = 'España'\n\n    def select_pos(self, country_name):\n        \"\"\"Seleccionar un POS/País específico (solo los 3 requeridos)\"\"\"\n        logger.info(f\"Seleccionando POS/País: {country_name}\")\n    \n        # Validar que sea uno de los 3 países requeridos\n        valid_countries = ['otros países', 'españa', 'chile']\n        if country_name.lower() not in valid_countries:\n            raise ValueError(f\"País no soportado: {country_name}. Solo se permiten: {valid_countries}\")\n    \n        # Primero abrir el dropdown\n        self.open_pos_dropdown()\n    \n        # Seleccionar el país específico\n        pos_map = {\n            'otros países': self.POS_OTHER_COUNTRIES,\n            'españa': self.POS_SPAIN,\n            'chile': self.POS_CHILE\n        }\n    \n        country_option = self.wait.until(EC.element_to_be_clickable(pos_map[country_name.lower()]))\n        country_option.click()\n    \n        # ✅ NUEVO PASO: Hacer clic en el botón Aplicar/Apply\n        apply_result = self.click_apply_button()\n    \n        if not apply_result:\n>           raise Exception(\"No se pudo hacer clic en el botón Aplicar/Apply\")\nE           Exception: No se pudo hacer clic en el botón Aplicar/Apply\n\npages\\home_page.py:220: Exception"}, "description": "\nCaso 5: Verificar cambio de POS (País)\n- Seleccionar 3 POS: Otros países, España, Chile\n- Verificar que cada cambio de POS se haga correctamente\n", "steps": [{"name": "1. Navegar a la página principal: https://nuxqa4.avtest.ink/", "status": "passed", "start": 1761876798879, "stop": 1761876801499}, {"name": "2. Cambiar POS a: España", "status": "broken", "statusDetails": {"message": "Exception: No se pudo hacer clic en el botón Aplicar/Apply\n", "trace": "  File \"C:\\Users\\DavidGalvezRestrepo\\DATOS\\DAVID\\EXAMEN\\project\\tests\\test_case_5.py\", line 50, in test_change_pos\n    home_page.select_pos(pos_country)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^\n  File \"C:\\Users\\DavidGalvezRestrepo\\DATOS\\DAVID\\EXAMEN\\project\\pages\\home_page.py\", line 220, in select_pos\n    raise Exception(\"No se pudo hacer clic en el botón Aplicar/Apply\")\n"}, "start": 1761876801499, "stop": 1761876834692}], "attachments": [{"name": "error_screenshot_pos_España", "source": "13f2ca1f-ff78-4961-9ba5-ac7fae5ce345-attachment.png", "type": "image/png"}, {"name": "video_pos_España", "source": "f08d5020-65e6-4ab0-bb17-86a05a2164dd-attachment.mp4", "type": "video/mp4"}, {"name": "log", "source": "c948ef52-2e38-4726-a0c1-bc3da93690b1-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "pos_country", "value": "'España'"}, {"name": "base_url", "value": "'https://nuxqa4.avtest.ink/'"}], "start": 1761876798879, "stop": 1761876834931, "uuid": "df97e615-63d6-4f42-89bd-7aab69f4049e", "historyId": "d4d78a995a4cf49b7f63537b3e90de58", "testCaseId": "a5ef926c4a75e1b9fb88eddb1cd81bcc", "fullName": "tests.test_case_5.TestCase5#test_change_pos", "labels": [{"name": "parentSuite", "value": "tests"}, {"name": "suite", "value": "test_case_5"}, {"name": "subSuite", "value": "TestCase5"}, {"name": "host", "value": "DESKTOP-EOEE1L3"}, {"name": "thread", "value": "16224-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.test_case_5"}]}